<!-- First, paste the whole content of download.htm -->
<!DOCTYPE html>
<html lang="hi-IN">
<head>
<!-- (all content from original download.htm's <head>) -->
<!-- ... (not shown for brevity) ... -->
</head>
<body>
<!-- (all content of original download.htm's <body> above the closing </body>) -->

<!-- Add Kenvi chat widget from index.html just before </body> -->

<!-- KENVI CHATBOT WIDGET START -->
<!-- Copy from index.html -->
<div id="chat-icon">
  <img src="https://4.bp.blogspot.com/-cKfxHZBZKNo/WIQaN1S0CwI/AAAAAAAAFAc/8CVgTVmG6ES8uVepCpzzYmwKyxvmyR7gCLcBs1600/kvs-logo-with-bg.png" alt="KVS Logo" />
</div>
<div id="chat-box">
  <div class="chat-header">
    <img src="https://4.bp.blogspot.com/-cKfxHZBZKNo/WIQaN1S0CwI/AAAAAAAAFAc/8CVgTVmG6ES8uVepCpzzYmwKyxvmyR7gCLcBs1600/kvs-logo-with-bg.png" alt="KVS Logo" />
    KENVI AI
  </div>
  <div class="chat-messages" id="chat-messages"></div>
  <div class="chat-input-area">
    <div class="suggestions">
      <div class="suggestion">School timings</div>
      <div class="suggestion">Hindi teacher</div>
      <div class="suggestion">Admission details</div>
      <div class="suggestion">Principal name</div>
    </div>
    <div class="chat-input">
      <input id="user-input" type="text" placeholder="Ask something..." />
      <button id="send-btn">Send</button>
    </div>
  </div>
</div>
<style>
body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
#chat-icon { position: fixed; bottom: 20px; right: 20px; background-color: maroon; border-radius: 50%; width: 60px; height: 60px; display: flex; justify-content: center; align-items: center; box-shadow: 0 3px 10px rgba(0,0,0,0.3); cursor: pointer; z-index: 999; }
#chat-icon img { width: 40px; height: 40px; border-radius: 50%; }
#chat-box { display: none; position: fixed; bottom: 90px; right: 20px; width: 320px; background-color: #fff; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); overflow: hidden; z-index: 999; }
.chat-header { background-color: maroon; color: #fff; padding: 8px 12px; display: flex; align-items: center; font-weight: bold; }
.chat-header img { height: 25px; width: 25px; margin-right: 8px; border-radius: 4px; }
.chat-messages { height: 260px; overflow-y: auto; padding: 10px; background: #fafafa; display: flex; flex-direction: column; }
.chat-input-area { display: flex; flex-direction: column; border-top: 1px solid #ddd; }
.suggestions { display: flex; flex-wrap: wrap; background: #f3f3f3; padding: 5px; gap: 5px; }
.suggestion { background: #fff; border: 1px solid #ccc; border-radius: 12px; padding: 4px 8px; font-size: 12px; cursor: pointer; transition: 0.2s; }
.suggestion:hover { background: #eee; }
.chat-input { display: flex; border-top: 1px solid #ccc; }
.chat-input input { flex: 1; border: none; padding: 10px; outline: none; }
.chat-input button { background-color: maroon; color: #fff; border: none; padding: 8px 16px; cursor: pointer; }
.message { margin: 6px 0; padding: 8px 10px; border-radius: 10px; max-width: 80%; line-height: 1.4; }
.user-message { background-color: #007bff; color: white; align-self: flex-end; }
.bot-message { background-color: #f1f1f1; color: black; align-self: flex-start; }
.thinking { display: flex; align-items: center; gap: 4px; }
.thinking span { width: 6px; height: 6px; background: gray; border-radius: 50%; animation: blink 1.4s infinite both; }
.thinking span:nth-child(2) { animation-delay: 0.2s; }
.thinking span:nth-child(3) { animation-delay: 0.4s; }
@keyframes blink { 0%, 80%, 100% { opacity: 0; } 40% { opacity: 1; } }
</style>
<script>
const chatIcon = document.getElementById('chat-icon');
const chatBox = document.getElementById('chat-box');
const chatMessages = document.getElementById('chat-messages');
const userInput = document.getElementById('user-input');
const sendBtn = document.getElementById('send-btn');
chatIcon.addEventListener('click', () => {
  chatBox.style.display = chatBox.style.display === 'none' ? 'block' : 'none';
  if (chatMessages.childElementCount === 0) showWelcome();
});
document.querySelectorAll('.suggestion').forEach(s => s.addEventListener('click', () => userInput.value = s.textContent));
function appendMessage(text, className) {
  const msg = document.createElement('div');
  msg.className = 'message ' + className;
  msg.textContent = text;
  chatMessages.appendChild(msg);
  chatMessages.scrollTop = chatMessages.scrollHeight;
  return msg;
}
function showWelcome() {
  appendMessage("Hello! I'm Kenvi, the virtual assistant for Kendriya Vidyalaya Bolarum. How can I help you today?", 'bot-message');
}
function showThinking() {
  const thinkDiv = document.createElement('div');
  thinkDiv.className = 'message bot-message thinking';
  thinkDiv.innerHTML = '<span></span><span></span><span></span>';
  chatMessages.appendChild(thinkDiv);
  chatMessages.scrollTop = chatMessages.scrollHeight;
  return thinkDiv;
}
sendBtn.addEventListener('click', sendMessage);
userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendMessage(); });
function sendMessage() {
  const text = userInput.value.trim();
  if (!text) return;
  appendMessage(text, 'user-message');
  userInput.value = '';
  const thinking = showThinking();
  fetch('http://127.0.0.1:5000/api/ask', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ question: text })
  })
    .then(res => res.json())
    .then(data => { thinking.remove(); appendMessage(data.answer, 'bot-message'); })
    .catch(() => { thinking.remove(); appendMessage("Sorry, I couldn't reach the server.", 'bot-message'); });
}
</script>
<!-- KENVI CHATBOT WIDGET END -->

<!-- (Rest of download.htm's original content including possible scripts and closing tags) -->
</body>
</html>